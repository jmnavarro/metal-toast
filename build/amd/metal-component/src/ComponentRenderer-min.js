define(["exports","metal-events/src/events"],function(e,n){"use strict";function t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function o(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),d=function(e){function d(e){r(this,d);var t=a(this,(d.__proto__||Object.getPrototypeOf(d)).call(this));return t.component_=e,t.componentRendererEvents_=new n.EventHandler,t.componentRendererEvents_.add(t.component_.once("render",t.render.bind(t))),t.on("rendered",t.handleRendered_),e.on("dataManagerCreated",t.handleDataManagerCreated_.bind(t)),t}return o(d,e),i(d,[{key:"disposeInternal",value:function(){this.componentRendererEvents_.removeAllListeners(),this.componentRendererEvents_=null}},{key:"getComponent",value:function(){return this.component_}},{key:"handleDataManagerCreated_",value:function(){var e=this.component_.getDataManager();this.component_.constructor.SYNC_UPDATES_MERGED?this.componentRendererEvents_.add(e.on("dataPropChanged",this.handleManagerDataPropChanged_.bind(this))):this.componentRendererEvents_.add(e.on("dataChanged",this.handleManagerDataChanged_.bind(this)))}},{key:"handleManagerDataChanged_",value:function(e){this.shouldRerender_()&&this.update(e)}},{key:"handleManagerDataPropChanged_",value:function(e){this.shouldRerender_()&&this.update({changes:t({},e.key,e)})}},{key:"handleRendered_",value:function(){this.isRendered_=!0}},{key:"render",value:function(){this.component_.element||(this.component_.element=document.createElement("div")),this.emit("rendered",!this.isRendered_)}},{key:"shouldRerender_",value:function(){return this.isRendered_&&!this.skipUpdates_}},{key:"startSkipUpdates",value:function(){this.skipUpdates_=!0}},{key:"stopSkipUpdates",value:function(){this.skipUpdates_=!1}},{key:"update",value:function(){}}]),d}(n.EventEmitter);e["default"]=d});