define(["exports","metal/src/metal","./domData","./DomDelegatedEventHandle","./DomEventHandle"],function(e,t,n,r,i){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,n){if((0,t.isObject)(e)&&(0,t.isString)(n)){e.length||(e=[e]);for(var r=0;r<e.length;r++)"classList"in e[r]?s(e[r],n):l(e[r],n)}}function s(e,t){t.split(" ").forEach(function(t){t&&e.classList.add(t)})}function l(e,t){var n=" "+e.className+" ",r="";t=t.split(" ");for(var i=0;i<t.length;i++){var o=t[i];n.indexOf(" "+o+" ")===-1&&(r+=" "+o)}r&&(e.className=e.className+r)}function c(e,t,n){var r=Y["default"].get(e);d(r.listeners,t,n)}function u(e,t,n,r){var i=Y["default"].get(e);d(i.delegating[t].selectors,n,r)}function d(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function f(e,t){var n=Y["default"].get(e);n.delegating[t]||(n.delegating[t]={handle:I(e,t,S,!!re[t]),selectors:{}})}function g(e,t){for(;e&&!_(e,t);)e=e.parentNode;return e}function m(e,n){if((0,t.isString)(n)&&(n=p(n)),n instanceof NodeList)for(var r=Array.prototype.slice.call(n),i=0;i<r.length;i++)e.appendChild(r[i]);else e.appendChild(n);return n}function p(e){var t=document.createElement("div");t.innerHTML="<br>"+e,t.removeChild(t.firstChild);for(var n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);return n}function v(e,n){return(0,t.isDocument)(e)?e.documentElement.contains(n):e.contains(n)}function h(e,n,r,i,o){var a=te[n];return a&&a.delegate&&(n=a.originalEvent,i=a.handler.bind(a,i)),o&&(i=i.bind(),i.defaultListener_=!0),f(e,n),(0,t.isString)(r)?u(e,n,r,i):c(r,n,i),new Z["default"]((0,t.isString)(r)?e:r,n,i,(0,t.isString)(r)?r:null)}function E(e,t,n){if(n&&"click"===t&&2===n.button)return!1;var r=["BUTTON","INPUT","SELECT","TEXTAREA","FIELDSET"];return!("click"===t&&r.indexOf(e.tagName)>-1)||!(e.disabled||P(e,"fieldset[disabled]"))}function N(e){e&&m(document.body,e)}function b(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function S(e){O(e);var n=(0,t.isDef)(e[ne])?e[ne]:e.target,r=!0,i=e.currentTarget,o=e.currentTarget.parentNode,a=[];return r&=R(i,n,e,o,a),r&=z(a,e),e.delegateTarget=null,e[ne]=o,r}function C(e,t){return"classList"in e?y(e,t):L(e,t)}function y(e,t){return e.classList.contains(t)}function L(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>=0}function T(e){return 0===e.childNodes.length}function _(e,t){if(!e||1!==e.nodeType)return!1;var n=Element.prototype,r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return r?r.call(e,t):x(e,t)}function x(e,t){for(var n=document.querySelectorAll(t,e.parentNode),r=0;r<n.length;++r)if(n[r]===e)return!0;return!1}function D(e,t){do if(e=e.nextSibling,e&&_(e,t))return e;while(e);return null}function O(e){e.stopPropagation=q,e.stopImmediatePropagation=F}function I(e,n,r,i){if((0,t.isString)(e))return h(document,n,e,r);var o=te[n];return o&&o.event&&(n=o.originalEvent,r=o.handler.bind(o,r)),e.addEventListener(n,r,i),new $["default"](e,n,r,i)}function M(e,t,n){var r=I(e,t,function(){return r.removeListener(),n.apply(this,arguments)});return r}function P(e,t){return g(e.parentNode,t)}function j(e,t){te[e]=t}function k(e){for(var t;t=e.firstChild;)e.removeChild(t)}function w(e,n){if((0,t.isObject)(e)&&(0,t.isString)(n)){e.length||(e=[e]);for(var r=0;r<e.length;r++)"classList"in e[r]?A(e[r],n):H(e[r],n)}}function A(e,t){t.split(" ").forEach(function(t){t&&e.classList.remove(t)})}function H(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++)n=n.replace(" "+t[r]+" "," ");e.className=n.trim()}function B(e,t){e&&t&&e!==t&&e.parentNode&&(e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e))}function F(){var e=this;e.stopped=!0,e.stoppedImmediate=!0,Event.prototype.stopImmediatePropagation.call(e)}function q(){var e=this;e.stopped=!0,Event.prototype.stopPropagation.call(e)}function U(e,n){return!!te[n]||((0,t.isString)(e)&&(ee[e]||(ee[e]=document.createElement(e)),e=ee[e]),"on"+n in e)}function z(e,t){for(var n=!0,r=0;r<e.length&&!t.defaultPrevented;r++)t.delegateTarget=e[r].element,n&=e[r].fn(t);return n}function R(e,t,n,r,i){for(var o=!0;t&&t!==r&&!n.stopped;)E(t,n.type,n)&&(n.delegateTarget=t,o&=W(e,t,n,i)),t=t.parentNode;return o}function X(e){return(0,t.isElement)(e)||(0,t.isDocument)(e)?e:(0,t.isString)(e)?"#"===e[0]&&e.indexOf(" ")===-1?document.getElementById(e.substr(1)):document.querySelector(e):null}function G(e,n){(0,t.isObject)(e)&&(0,t.isString)(n)&&("classList"in e?J(e,n):K(e,n))}function J(e,t){t.split(" ").forEach(function(t){e.classList.toggle(t)})}function K(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++){var i=" "+t[r]+" ",o=n.indexOf(i);n=o===-1?n+t[r]+" ":n.substring(0,o)+" "+n.substring(o+i.length)}e.className=n.trim()}function Q(e,n,r){if(E(e,n,r)){var i=document.createEvent("HTMLEvents");i.initEvent(n,!0,!0),t.object.mixin(i,r),e.dispatchEvent(i)}}function V(e,t,n,r){var i=!0;e=e||[];for(var o=0;o<e.length&&!t.stoppedImmediate;o++)e[o].defaultListener_?r.push({element:n,fn:e[o]}):i&=e[o](t);return i}function W(e,t,n,r){for(var i=Y["default"].get(t),o=i.listeners[n.type],a=V(o,n,t,r),s=Y["default"].get(e).delegating[n.type].selectors,l=Object.keys(s),c=0;c<l.length&&!n.stoppedImmediate;c++)_(t,l[c])&&(o=s[l[c]],a&=V(o,n,t,r));return a}Object.defineProperty(e,"__esModule",{value:!0}),e.customEvents=void 0,e.addClasses=a,e.closest=g,e.append=m,e.buildFragment=p,e.contains=v,e.delegate=h,e.enterDocument=N,e.exitDocument=b,e.hasClass=C,e.isEmpty=T,e.match=_,e.next=D,e.on=I,e.once=M,e.parent=P,e.registerCustomEvent=j,e.removeChildren=k,e.removeClasses=w,e.replace=B,e.supportsEvent=U,e.toElement=X,e.toggleClasses=G,e.triggerEvent=Q;var Y=o(n),Z=o(r),$=o(i),ee={},te=e.customEvents={},ne="__metal_next_target__",re={blur:!0,error:!0,focus:!0,invalid:!0,load:!0,scroll:!0}});