define(["exports","metal/src/metal","./dom"],function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var c=r(t),i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),a=function(){function e(){u(this,e)}return i(e,null,[{key:"run",value:function(e,n){var t=document.createElement("script");return t.text=e,n?n(t):document.head.appendChild(t),c["default"].exitDocument(t),t}},{key:"runFile",value:function(e,n,t){var r=document.createElement("script");r.src=e;var u=function(){c["default"].exitDocument(r),n&&n()};return c["default"].once(r,"load",u),c["default"].once(r,"error",u),t?t(r):document.head.appendChild(r),r}},{key:"runScript",value:function(t,r,u){var i=function(){r&&r()};return t.type&&"text/javascript"!==t.type?void n.async.nextTick(i):(c["default"].exitDocument(t),t.src?e.runFile(t.src,r,u):(n.async.nextTick(i),e.run(t.text,u)))}},{key:"runScriptsInElement",value:function(t,r,u){var c=t.querySelectorAll("script");c.length?e.runScriptsInOrder(c,0,r,u):r&&n.async.nextTick(r)}},{key:"runScriptsInOrder",value:function(t,r,u,c){e.runScript(t.item(r),function(){r<t.length-1?e.runScriptsInOrder(t,r+1,u,c):u&&n.async.nextTick(u)},c)}}]),e}();e["default"]=a});