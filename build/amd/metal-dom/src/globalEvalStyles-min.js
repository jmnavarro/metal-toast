define(["exports","metal/src/metal","./dom"],function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var l=r(t),a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=function(){function e(){u(this,e)}return a(e,null,[{key:"run",value:function(e,n){var t=document.createElement("style");return t.innerHTML=e,n?n(t):document.head.appendChild(t),t}},{key:"runFile",value:function(n,t,r){var u=document.createElement("link");return u.rel="stylesheet",u.href=n,e.runStyle(u,t,r),u}},{key:"runStyle",value:function(e,t,r){var u=function(){t&&t()};return e.rel&&"stylesheet"!==e.rel?void n.async.nextTick(u):("STYLE"===e.tagName?n.async.nextTick(u):(l["default"].once(e,"load",u),l["default"].once(e,"error",u)),r?r(e):document.head.appendChild(e),e)}},{key:"runStylesInElement",value:function(t,r,u){var l=t.querySelectorAll("style,link");if(0===l.length&&r)return void n.async.nextTick(r);for(var a=0,o=function(){r&&++a===l.length&&n.async.nextTick(r)},c=0;c<l.length;c++)e.runStyle(l[c],o,u)}}]),e}();e["default"]=o});